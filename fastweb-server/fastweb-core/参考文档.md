# fastweb-core ç²¾ç®€ç‰ˆåŠŸèƒ½è®¾è®¡æ–¹æ¡ˆï¼ˆ12æ¨¡å—ï¼‰

> ä¸‹é¢çš„æ–‡æ¡£æ—¨åœ¨ä¼ è¾¾å®è§‚çš„è®¾è®¡å±‚é¢çš„æ¦‚å¿µï¼Œä¸æ˜¯å…·ä½“å®ç°çš„å…·ä½“ä»£ç ï¼ï¼ï¼

## å®æ–½ä¼˜å…ˆçº§åˆ†å±‚

### ğŸ”¥ æ ¸å¿ƒåŸºç¡€å±‚ï¼ˆPhase 1 - å¿…é¡»ä¼˜å…ˆå®ç°ï¼‰

#### 1. **fastweb-core-common**ï¼ˆå…¬å…±åŸºç¡€æ¨¡å—ï¼‰

**åŸºç¡€åŠŸèƒ½**ï¼š

- é€šç”¨å·¥å…·ç±»ï¼šDateUtilsã€StringUtilsã€JsonUtilsã€UUIDUtilsã€ConfigUtils
- ç»Ÿä¸€å“åº”ä½“ï¼šResult<T>ã€PageResult<T>ã€ApiResponse
- åŸºç¡€å®ä½“ç±»ï¼šBaseEntityï¼ˆidã€createTimeã€updateTimeã€createByã€updateByï¼‰
- æšä¸¾å®šä¹‰ï¼šStatusEnumã€TypeEnumã€DeleteEnum
- å¸¸é‡å®šä¹‰ï¼šç³»ç»Ÿå¸¸é‡ã€é”™è¯¯ç å¸¸é‡ã€é…ç½®é”®åå¸¸é‡
- **é…ç½®ç®¡ç†**ï¼šå¤šç¯å¢ƒé…ç½®åŠ è½½ã€é…ç½®åŠ å¯†è§£å¯†ã€åŠ¨æ€é…ç½®åˆ·æ–°

**æŠ€æœ¯å®ç°**ï¼š

```java
// ç»Ÿä¸€å“åº”ä½“
public class Result<T> {
    private Integer code;
    private String message;
    private T data;
    private Long timestamp;
}

// åŸºç¡€å®ä½“
@MappedSuperclass
public class BaseEntity {
    private Long id;
    private LocalDateTime createTime;
    private LocalDateTime updateTime;
    private String createBy;
    private String updateBy;
    private Integer deleteFlag;
}

// é…ç½®å·¥å…·ç±»ï¼ˆæ•´åˆåˆ°commonæ¨¡å—ï¼‰
public class ConfigUtils {
    public static String getConfig(String key, String defaultValue) { ...}

    public static <T> T getConfigObject(String key, Class<T> clazz) { ...}
}
```

#### 2. **fastweb-core-exception**ï¼ˆå¼‚å¸¸å¤„ç†æ¨¡å—ï¼‰

**æ ¸å¿ƒåŠŸèƒ½**ï¼š

- å…¨å±€å¼‚å¸¸å¤„ç†ï¼š@ControllerAdvice + @ExceptionHandler
- è‡ªå®šä¹‰å¼‚å¸¸ä½“ç³»ï¼šBaseExceptionã€BusinessExceptionã€ValidationException
- é”™è¯¯ç è§„èŒƒï¼šA0001ï¼ˆç”¨æˆ·ç«¯é”™è¯¯ï¼‰ã€B0001ï¼ˆç³»ç»Ÿæ‰§è¡Œé”™è¯¯ï¼‰ã€C0001ï¼ˆè°ƒç”¨ç¬¬ä¸‰æ–¹é”™è¯¯ï¼‰
- å¼‚å¸¸ä¿¡æ¯å›½é™…åŒ–ï¼šæ”¯æŒå¤šè¯­è¨€é”™è¯¯æç¤º

**æŠ€æœ¯å®ç°**ï¼š

```java

@ControllerAdvice
public class GlobalExceptionHandler {
    @ExceptionHandler(BusinessException.class)
    public Result<Void> handleBusinessException(BusinessException e) {
        return Result.error(e.getCode(), e.getMessage());
    }
}
```

### ğŸš€ æ ¸å¿ƒä¸šåŠ¡å±‚ï¼ˆPhase 2 - å…³é”®ä¸šåŠ¡åŠŸèƒ½ï¼‰

#### 3. **fastweb-core-security**ï¼ˆå®‰å…¨è®¤è¯æ¨¡å—ï¼‰

**è®¤è¯æˆæƒ**ï¼š

- JWT Tokenç®¡ç†ï¼šç”Ÿæˆã€éªŒè¯ã€åˆ·æ–°ã€é»‘åå•
- RBACæƒé™æ¨¡å‹ï¼šUser-Role-Permissionä¸‰è¡¨è®¾è®¡
- æ³¨è§£å¼æƒé™ï¼š@PreAuthorizeã€@HasRoleã€@HasPermission
- å¯†ç ç­–ç•¥ï¼šBCryptåŠ å¯†ã€å¯†ç å¼ºåº¦æ ¡éªŒã€å†å²å¯†ç æ£€æŸ¥

**å®‰å…¨é˜²æŠ¤**ï¼š

- XSSé˜²æŠ¤ï¼šè¾“å…¥å‚æ•°HTMLè½¬ä¹‰
- CSRFé˜²æŠ¤ï¼šTokenéªŒè¯
- SQLæ³¨å…¥é˜²æŠ¤ï¼šå‚æ•°åŒ–æŸ¥è¯¢å¼ºåˆ¶æ£€æŸ¥
- æ¥å£é™æµï¼šåŸºäºIP/ç”¨æˆ·çš„è®¿é—®é¢‘ç‡é™åˆ¶

#### 4. **fastweb-core-data**ï¼ˆæ•°æ®è®¿é—®æ¨¡å—ï¼‰

**æ•°æ®æºç®¡ç†**ï¼š

- å¤šæ•°æ®æºé…ç½®ï¼š@DataSourceæ³¨è§£åŠ¨æ€åˆ‡æ¢
- è¯»å†™åˆ†ç¦»ï¼šMaster-Slaveè·¯ç”±ç­–ç•¥
- åˆ†åº“åˆ†è¡¨ï¼šShardingSphereé›†æˆ

**ORMå¢å¼º**ï¼š

- MyBatis-Plusé›†æˆï¼šBaseMapper<T>ã€IService<T>
- æ•°æ®å®¡è®¡ï¼š@CreatedByã€@LastModifiedByè‡ªåŠ¨å¡«å……
- è½¯åˆ é™¤ï¼šé€»è¾‘åˆ é™¤æ‹¦æˆªå™¨
- åˆ†é¡µæ’ä»¶ï¼šç»Ÿä¸€åˆ†é¡µå‚æ•°å’Œè¿”å›æ ¼å¼

#### 5. **fastweb-core-cache**ï¼ˆç¼“å­˜ç®¡ç†æ¨¡å—ï¼‰

**å¤šçº§ç¼“å­˜**ï¼š

- æœ¬åœ°ç¼“å­˜ï¼šCaffeineä¸€çº§ç¼“å­˜
- åˆ†å¸ƒå¼ç¼“å­˜ï¼šRedisäºŒçº§ç¼“å­˜
- ç¼“å­˜åŒæ­¥ï¼šæœ¬åœ°ç¼“å­˜å¤±æ•ˆé€šçŸ¥æœºåˆ¶

**ç¼“å­˜ç­–ç•¥**ï¼š

- æ³¨è§£å¼ç¼“å­˜ï¼š@Cacheableã€@CacheEvictã€@CachePutå¢å¼ºç‰ˆ
- ç¼“å­˜ç©¿é€ï¼šå¸ƒéš†è¿‡æ»¤å™¨ + ç©ºå€¼ç¼“å­˜
- ç¼“å­˜é›ªå´©ï¼šè¿‡æœŸæ—¶é—´éšæœºåŒ–
- åˆ†å¸ƒå¼é”ï¼š@DistributedLockæ³¨è§£ï¼ŒRedissonå®ç°

### ğŸ›  æ‰©å±•åŠŸèƒ½å±‚ï¼ˆPhase 3 - å¢å¼ºåŠŸèƒ½ï¼‰

#### 6. **fastweb-core-storage**ï¼ˆæ–‡ä»¶å­˜å‚¨æ¨¡å—ï¼‰

**å¤šå­˜å‚¨é€‚é…**ï¼š

- å­˜å‚¨ç­–ç•¥æ¨¡å¼ï¼šLocalStorageã€OSSStorageã€MinIOStorage
- ç»Ÿä¸€å­˜å‚¨æ¥å£ï¼šFileStorageService
- å­˜å‚¨é…ç½®ï¼šæ”¯æŒå¤šä¸ªå­˜å‚¨æºé…ç½®å’Œåˆ‡æ¢

**æ–‡ä»¶æœåŠ¡**ï¼š

- æ–‡ä»¶ä¸Šä¼ ï¼šå•æ–‡ä»¶ã€æ‰¹é‡ã€åˆ†ç‰‡ä¸Šä¼ 
- æ–‡ä»¶ä¸‹è½½ï¼šæ”¯æŒæ–­ç‚¹ç»­ä¼ ã€é¢„ç­¾åURL
- å›¾ç‰‡å¤„ç†ï¼šç¼©ç•¥å›¾ç”Ÿæˆã€æ°´å°æ·»åŠ ã€æ ¼å¼è½¬æ¢
- æ–‡ä»¶å®‰å…¨ï¼šæ–‡ä»¶ç±»å‹æ£€æŸ¥ã€ç—…æ¯’æ‰«æã€è®¿é—®æƒé™æ§åˆ¶

#### 7. **fastweb-core-message**ï¼ˆæ¶ˆæ¯é€šä¿¡æ¨¡å—ï¼‰

**æ¶ˆæ¯ä¸­é—´ä»¶**ï¼š

- ç»Ÿä¸€æ¶ˆæ¯æ¥å£ï¼šMessageProducerã€MessageConsumer
- å¤šMQé€‚é…ï¼šKafkaã€RabbitMQã€RocketMQé€‚é…å™¨
- Spring Cloud Streamé›†æˆ

**æ¶ˆæ¯å¯é æ€§**ï¼š

- äº‹åŠ¡æ¶ˆæ¯ï¼šæœ¬åœ°æ¶ˆæ¯è¡¨ + å®šæ—¶è¡¥å¿
- é‡è¯•æœºåˆ¶ï¼šæŒ‡æ•°é€€é¿é‡è¯•ç­–ç•¥
- æ­»ä¿¡å¤„ç†ï¼šå¤±è´¥æ¶ˆæ¯è½¬ç§»åˆ°æ­»ä¿¡é˜Ÿåˆ—
- æ¶ˆæ¯è¿½è¸ªï¼šæ¶ˆæ¯è½¨è¿¹è¿½è¸ªå’Œç›‘æ§

#### 8. **fastweb-core-task**ï¼ˆä»»åŠ¡è°ƒåº¦æ¨¡å—ï¼‰

**ä»»åŠ¡è°ƒåº¦**ï¼š

- åˆ†å¸ƒå¼è°ƒåº¦ï¼šXXL-JOBã€PowerJobé›†æˆé€‰æ‹©
- æœ¬åœ°è°ƒåº¦ï¼š@Scheduledå¢å¼ºç‰ˆ
- å»¶è¿Ÿä»»åŠ¡ï¼šRediså»¶è¿Ÿé˜Ÿåˆ—ã€RocketMQå»¶è¿Ÿæ¶ˆæ¯

**ä»»åŠ¡ç®¡ç†**ï¼š

- ä»»åŠ¡ç›‘æ§ï¼šæ‰§è¡ŒçŠ¶æ€ã€è€—æ—¶ç»Ÿè®¡ã€å¤±è´¥ç‡
- ä»»åŠ¡æ²»ç†ï¼šä»»åŠ¡ä¾èµ–ç®¡ç†ã€ä»»åŠ¡åˆ†ç»„
- æ‰¹å¤„ç†ï¼šSpring Batché›†æˆï¼Œå¤§æ•°æ®é‡å¤„ç†

### ğŸ“Š ç›‘æ§è¿ç»´å±‚ï¼ˆPhase 4 - ç›‘æ§å‘Šè­¦ï¼‰

#### 9. **fastweb-core-monitor**ï¼ˆç›‘æ§å‘Šè­¦æ¨¡å—ï¼‰

**æŒ‡æ ‡ç›‘æ§**ï¼š

- æŒ‡æ ‡é‡‡é›†ï¼šMicrometer + Prometheus
- å¥åº·æ£€æŸ¥ï¼šæ•°æ®åº“ã€Redisã€æ¶ˆæ¯é˜Ÿåˆ—è¿é€šæ€§æ£€æŸ¥
- è‡ªå®šä¹‰æŒ‡æ ‡ï¼šä¸šåŠ¡æŒ‡æ ‡åŸ‹ç‚¹å’Œé‡‡é›†

**é“¾è·¯è¿½è¸ª**ï¼š

- åˆ†å¸ƒå¼è¿½è¸ªï¼šSpring Cloud Sleuth + Zipkin/Jaeger
- æ—¥å¿—å…³è”ï¼šTraceIdè‡ªåŠ¨æ³¨å…¥æ—¥å¿—
- æ€§èƒ½åˆ†æï¼šæ…¢SQLæ£€æµ‹ã€æ¥å£è€—æ—¶åˆ†æ

**å‘Šè­¦é€šçŸ¥**ï¼š

- å‘Šè­¦è§„åˆ™ï¼šé˜ˆå€¼å‘Šè­¦ã€å¼‚å¸¸å‘Šè­¦
- é€šçŸ¥æ¸ é“ï¼šé’‰é’‰ã€é£ä¹¦ã€é‚®ä»¶ã€çŸ­ä¿¡
- å‘Šè­¦æ”¶æ•›ï¼šç›¸åŒå‘Šè­¦åˆå¹¶ã€å‘Šè­¦é™é»˜

#### 10. **fastweb-core-audit**ï¼ˆå®¡è®¡æ—¥å¿—æ¨¡å—ï¼‰

**æ“ä½œå®¡è®¡**ï¼š

- æ“ä½œæ—¥å¿—ï¼š@AuditLogæ³¨è§£è‡ªåŠ¨è®°å½•
- ç™»å½•å®¡è®¡ï¼šç™»å½•æˆåŠŸ/å¤±è´¥ã€å¼‚åœ°ç™»å½•æ£€æµ‹
- æ•°æ®å˜æ›´ï¼šHibernate Enversæ•°æ®ç‰ˆæœ¬ç®¡ç†
- æ•æ„Ÿæ“ä½œï¼šæƒé™å˜æ›´ã€æ•°æ®å¯¼å‡ºç­‰å…³é”®æ“ä½œ

**æ—¥å¿—ç®¡ç†**ï¼š

- æ—¥å¿—è„±æ•ï¼šæ‰‹æœºå·ã€èº«ä»½è¯ç­‰æ•æ„Ÿä¿¡æ¯è„±æ•
- æ—¥å¿—æ£€ç´¢ï¼šåŸºäºElasticsearchçš„æ—¥å¿—æ£€ç´¢
- æ—¥å¿—å½’æ¡£ï¼šæ—¥å¿—åˆ†çº§å­˜å‚¨å’Œå®šæœŸæ¸…ç†

### ğŸ” ä¸šåŠ¡å¢å¼ºå±‚ï¼ˆPhase 5 - ä¸šåŠ¡æ‰©å±•ï¼‰

#### 11. **fastweb-core-doc**ï¼ˆæ¥å£æ–‡æ¡£æ¨¡å—ï¼‰

**æ–‡æ¡£ç”Ÿæˆ**ï¼š

- OpenAPI3é›†æˆï¼šSpringDocå¢å¼ºé…ç½®
- æ¥å£åˆ†ç»„ï¼šæŒ‰ä¸šåŠ¡æ¨¡å—ã€ç‰ˆæœ¬åˆ†ç»„
- æ–‡æ¡£ç¾åŒ–ï¼šKnife4j UIå¢å¼º

**æ–‡æ¡£å®‰å…¨**ï¼š

- è®¿é—®æ§åˆ¶ï¼šç”Ÿäº§ç¯å¢ƒæ–‡æ¡£è®¿é—®æƒé™
- æ¥å£Mockï¼šåŸºäºæ–‡æ¡£çš„Mockæ•°æ®ç”Ÿæˆ
- ç‰ˆæœ¬ç®¡ç†ï¼šAPIç‰ˆæœ¬æ§åˆ¶å’Œå…¼å®¹æ€§æ£€æŸ¥

#### 12. **fastweb-core-tenant**ï¼ˆå¤šç§Ÿæˆ·æ¨¡å—ï¼‰

**ç§Ÿæˆ·éš”ç¦»**ï¼š

- éš”ç¦»ç­–ç•¥ï¼šå­—æ®µéš”ç¦»ã€Schemaéš”ç¦»ã€æ•°æ®åº“éš”ç¦»
- ç§Ÿæˆ·ä¸Šä¸‹æ–‡ï¼šTenantContext + æ‹¦æˆªå™¨è‡ªåŠ¨æ³¨å…¥
- åŠ¨æ€æ•°æ®æºï¼šç§Ÿæˆ·çº§åˆ«æ•°æ®æºè·¯ç”±

**ç§Ÿæˆ·ç®¡ç†**ï¼š

- ç§Ÿæˆ·è¯†åˆ«ï¼šHeaderã€åŸŸåã€Tokenå¤šç§è¯†åˆ«æ–¹å¼
- ç§Ÿæˆ·é…ç½®ï¼šç‹¬ç«‹çš„èœå•ã€è§’è‰²ã€æƒé™é…ç½®
- ç§Ÿæˆ·ç›‘æ§ï¼šç§Ÿæˆ·çº§åˆ«çš„èµ„æºä½¿ç”¨ç»Ÿè®¡

## å®æ–½å»ºè®®

### å¼€å‘é¡ºåº

1. **Phase 1**ï¼šcommon â†’ exceptionï¼ˆ1å‘¨ï¼‰
2. **Phase 2**ï¼šsecurity â†’ data â†’ cacheï¼ˆ2-3å‘¨ï¼‰
3. **Phase 3**ï¼šstorage â†’ message â†’ taskï¼ˆ2-3å‘¨ï¼‰
4. **Phase 4**ï¼šmonitor â†’ auditï¼ˆ1-2å‘¨ï¼‰
5. **Phase 5**ï¼šdoc â†’ tenantï¼ˆ1-2å‘¨ï¼‰

### æŠ€æœ¯é€‰å‹

- **åŸºç¡€æ¡†æ¶**ï¼šSpring Boot 2.7+ / Spring Cloud 2021+
- **æ•°æ®åº“**ï¼šMySQL 8.0 + MyBatis-Plus 3.5+
- **ç¼“å­˜**ï¼šRedis 6.0 + Caffeine
- **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šRocketMQ / Kafkaï¼ˆæ ¹æ®ä¸šåŠ¡é€‰æ‹©ï¼‰
- **ç›‘æ§**ï¼šPrometheus + Grafana + Jaeger

### è´¨é‡ä¿è¯

- **å•å…ƒæµ‹è¯•**ï¼šæ¯ä¸ªæ¨¡å—è¦†ç›–ç‡ > 80%
- **é›†æˆæµ‹è¯•**ï¼šå…³é”®é“¾è·¯ç«¯åˆ°ç«¯æµ‹è¯•
- **æ€§èƒ½æµ‹è¯•**ï¼šæ ¸å¿ƒæ¥å£æ€§èƒ½åŸºå‡†æµ‹è¯•
- **å®‰å…¨æµ‹è¯•**ï¼šå®‰å…¨æ¼æ´æ‰«æå’Œä¿®å¤

### æ–‡æ¡£è§„èŒƒ

- **è®¾è®¡æ–‡æ¡£**ï¼šæ¯ä¸ªæ¨¡å—çš„è®¾è®¡æ–‡æ¡£å’Œæ¥å£å®šä¹‰
- **ä½¿ç”¨è¯´æ˜**ï¼šè¯¦ç»†çš„ä½¿ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ
- **éƒ¨ç½²æŒ‡å—**ï¼šç¯å¢ƒæ­å»ºå’Œéƒ¨ç½²é…ç½®è¯´æ˜